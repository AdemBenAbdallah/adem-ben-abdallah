[
  {
    "slug": "blog/handling-asyc-data",
    "title": "Handling Asynchronous Data Fetching in React Beyond the Basics",
    "description": "Handling asynchronous data fetching in React",
    "date": "2024-08-08T00:00:00.000Z",
    "published": true,
    "tags": [
      "react js",
      "react-query"
    ],
    "body": "const{Fragment:l,jsx:n,jsxs:e}=arguments[0];function _createMdxContent(r){const s={a:\"a\",blockquote:\"blockquote\",code:\"code\",figure:\"figure\",h2:\"h2\",li:\"li\",p:\"p\",pre:\"pre\",span:\"span\",strong:\"strong\",ul:\"ul\",...r.components},{Link:o}=s;return o||function(l,n){throw new Error(\"Expected \"+(n?\"component\":\"object\")+\" `\"+l+\"` to be defined: you likely forgot to import, pass, or provide it.\")}(\"Link\",!0),e(l,{children:[n(s.p,{children:\"If you've ever fetched data in a React app, you've likely encountered a basic pattern like this:\"}),\"\\n\",n(s.figure,{\"data-rehype-pretty-code-figure\":\"\",children:n(s.pre,{style:{backgroundColor:\"#24292e\",color:\"#e1e4e8\"},tabIndex:\"0\",\"data-language\":\"js\",\"data-theme\":\"github-dark\",children:e(s.code,{\"data-language\":\"js\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:[e(s.span,{\"data-line\":\"\",children:[n(s.span,{style:{color:\"#F97583\"},children:\"const\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\" [\"}),n(s.span,{style:{color:\"#79B8FF\"},children:\"id\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\", \"}),n(s.span,{style:{color:\"#79B8FF\"},children:\"setId\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\"] \"}),n(s.span,{style:{color:\"#F97583\"},children:\"=\"}),n(s.span,{style:{color:\"#B392F0\"},children:\" useState\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),n(s.span,{style:{color:\"#79B8FF\"},children:\"1\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\");\"})]}),\"\\n\",n(s.span,{\"data-line\":\"\",children:\" \"}),\"\\n\",e(s.span,{\"data-line\":\"\",children:[n(s.span,{style:{color:\"#B392F0\"},children:\"useEffect\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\"(() \"}),n(s.span,{style:{color:\"#F97583\"},children:\"=>\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\" {\"})]}),\"\\n\",e(s.span,{\"data-line\":\"\",children:[n(s.span,{style:{color:\"#B392F0\"},children:\"  fetch\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),n(s.span,{style:{color:\"#9ECBFF\"},children:\"`https://pokeapi.co/api/v2/pokemon/${\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\"id\"}),n(s.span,{style:{color:\"#9ECBFF\"},children:\"}`\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\")\"})]}),\"\\n\",e(s.span,{\"data-line\":\"\",children:[n(s.span,{style:{color:\"#E1E4E8\"},children:\"    .\"}),n(s.span,{style:{color:\"#B392F0\"},children:\"then\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\"((\"}),n(s.span,{style:{color:\"#FFAB70\"},children:\"response\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\") \"}),n(s.span,{style:{color:\"#F97583\"},children:\"=>\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\" response.\"}),n(s.span,{style:{color:\"#B392F0\"},children:\"json\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\"())\"})]}),\"\\n\",e(s.span,{\"data-line\":\"\",children:[n(s.span,{style:{color:\"#E1E4E8\"},children:\"    .\"}),n(s.span,{style:{color:\"#B392F0\"},children:\"then\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\"((\"}),n(s.span,{style:{color:\"#FFAB70\"},children:\"data\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\") \"}),n(s.span,{style:{color:\"#F97583\"},children:\"=>\"}),n(s.span,{style:{color:\"#B392F0\"},children:\" setPokemon\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\"(data))\"})]}),\"\\n\",e(s.span,{\"data-line\":\"\",children:[n(s.span,{style:{color:\"#E1E4E8\"},children:\"    .\"}),n(s.span,{style:{color:\"#B392F0\"},children:\"catch\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\"((\"}),n(s.span,{style:{color:\"#FFAB70\"},children:\"error\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\") \"}),n(s.span,{style:{color:\"#F97583\"},children:\"=>\"}),n(s.span,{style:{color:\"#B392F0\"},children:\" setError\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\"(error));\"})]}),\"\\n\",n(s.span,{\"data-line\":\"\",children:n(s.span,{style:{color:\"#E1E4E8\"},children:\"}, [id]);\"})})]})})}),\"\\n\",n(s.p,{children:\"This code fetches data from the PokemonAPI and displays it.\\nWhile it's great for tutorials, you definitely wouldnâ€™t want to use it in production unless you enjoy debugging at 3 AM.\\nLetâ€™s dive into some common pitfalls and how to avoid them.\"}),\"\\n\",n(s.h2,{id:\"1-handling-loading-and-error-states\",children:n(s.a,{className:\"subheading-anchor\",\"aria-label\":\"Link to section\",href:\"#1-handling-loading-and-error-states\",children:n(s.strong,{children:\"1. Handling Loading and Error States\"})})}),\"\\n\",n(s.p,{children:\"The initial example doesnâ€™t handle loading and error states,\\nleading to two major UX issues: cumulative layout shift and an infinite spinner.\\nTo address this, you should manage these states explicitly:\"}),\"\\n\",n(s.figure,{\"data-rehype-pretty-code-figure\":\"\",children:n(s.pre,{style:{backgroundColor:\"#24292e\",color:\"#e1e4e8\"},tabIndex:\"0\",\"data-language\":\"js\",\"data-theme\":\"github-dark\",children:e(s.code,{\"data-language\":\"js\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:[e(s.span,{\"data-line\":\"\",children:[n(s.span,{style:{color:\"#F97583\"},children:\"const\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\" [\"}),n(s.span,{style:{color:\"#79B8FF\"},children:\"id\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\", \"}),n(s.span,{style:{color:\"#79B8FF\"},children:\"setId\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\"] \"}),n(s.span,{style:{color:\"#F97583\"},children:\"=\"}),n(s.span,{style:{color:\"#B392F0\"},children:\" useState\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),n(s.span,{style:{color:\"#79B8FF\"},children:\"1\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\");\"})]}),\"\\n\",e(s.span,{\"data-line\":\"\",children:[n(s.span,{style:{color:\"#F97583\"},children:\"const\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\" [\"}),n(s.span,{style:{color:\"#79B8FF\"},children:\"pokemon\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\", \"}),n(s.span,{style:{color:\"#79B8FF\"},children:\"setPokemon\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\"] \"}),n(s.span,{style:{color:\"#F97583\"},children:\"=\"}),n(s.span,{style:{color:\"#B392F0\"},children:\" useState\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),n(s.span,{style:{color:\"#79B8FF\"},children:\"null\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\");\"})]}),\"\\n\",e(s.span,{\"data-line\":\"\",children:[n(s.span,{style:{color:\"#F97583\"},children:\"const\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\" [\"}),n(s.span,{style:{color:\"#79B8FF\"},children:\"loading\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\", \"}),n(s.span,{style:{color:\"#79B8FF\"},children:\"setLoading\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\"] \"}),n(s.span,{style:{color:\"#F97583\"},children:\"=\"}),n(s.span,{style:{color:\"#B392F0\"},children:\" useState\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),n(s.span,{style:{color:\"#79B8FF\"},children:\"false\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\");\"})]}),\"\\n\",e(s.span,{\"data-line\":\"\",children:[n(s.span,{style:{color:\"#F97583\"},children:\"const\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\" [\"}),n(s.span,{style:{color:\"#79B8FF\"},children:\"error\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\", \"}),n(s.span,{style:{color:\"#79B8FF\"},children:\"setError\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\"] \"}),n(s.span,{style:{color:\"#F97583\"},children:\"=\"}),n(s.span,{style:{color:\"#B392F0\"},children:\" useState\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),n(s.span,{style:{color:\"#79B8FF\"},children:\"null\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\");\"})]}),\"\\n\",n(s.span,{\"data-line\":\"\",children:\" \"}),\"\\n\",e(s.span,{\"data-line\":\"\",children:[n(s.span,{style:{color:\"#B392F0\"},children:\"useEffect\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\"(() \"}),n(s.span,{style:{color:\"#F97583\"},children:\"=>\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\" {\"})]}),\"\\n\",e(s.span,{\"data-line\":\"\",children:[n(s.span,{style:{color:\"#B392F0\"},children:\"  setLoading\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),n(s.span,{style:{color:\"#79B8FF\"},children:\"true\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\");\"})]}),\"\\n\",e(s.span,{\"data-line\":\"\",children:[n(s.span,{style:{color:\"#B392F0\"},children:\"  fetch\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),n(s.span,{style:{color:\"#9ECBFF\"},children:\"`https://pokeapi.co/api/v2/pokemon/${\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\"id\"}),n(s.span,{style:{color:\"#9ECBFF\"},children:\"}`\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\")\"})]}),\"\\n\",e(s.span,{\"data-line\":\"\",children:[n(s.span,{style:{color:\"#E1E4E8\"},children:\"    .\"}),n(s.span,{style:{color:\"#B392F0\"},children:\"then\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\"((\"}),n(s.span,{style:{color:\"#FFAB70\"},children:\"response\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\") \"}),n(s.span,{style:{color:\"#F97583\"},children:\"=>\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\" response.\"}),n(s.span,{style:{color:\"#B392F0\"},children:\"json\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\"())\"})]}),\"\\n\",e(s.span,{\"data-line\":\"\",children:[n(s.span,{style:{color:\"#E1E4E8\"},children:\"    .\"}),n(s.span,{style:{color:\"#B392F0\"},children:\"then\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\"((\"}),n(s.span,{style:{color:\"#FFAB70\"},children:\"data\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\") \"}),n(s.span,{style:{color:\"#F97583\"},children:\"=>\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\" {\"})]}),\"\\n\",e(s.span,{\"data-line\":\"\",children:[n(s.span,{style:{color:\"#B392F0\"},children:\"      setPokemon\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\"(data);\"})]}),\"\\n\",e(s.span,{\"data-line\":\"\",children:[n(s.span,{style:{color:\"#B392F0\"},children:\"      setLoading\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),n(s.span,{style:{color:\"#79B8FF\"},children:\"false\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\");\"})]}),\"\\n\",n(s.span,{\"data-line\":\"\",children:n(s.span,{style:{color:\"#E1E4E8\"},children:\"    })\"})}),\"\\n\",e(s.span,{\"data-line\":\"\",children:[n(s.span,{style:{color:\"#E1E4E8\"},children:\"    .\"}),n(s.span,{style:{color:\"#B392F0\"},children:\"catch\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\"((\"}),n(s.span,{style:{color:\"#FFAB70\"},children:\"error\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\") \"}),n(s.span,{style:{color:\"#F97583\"},children:\"=>\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\" {\"})]}),\"\\n\",e(s.span,{\"data-line\":\"\",children:[n(s.span,{style:{color:\"#B392F0\"},children:\"      setError\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\"(error);\"})]}),\"\\n\",e(s.span,{\"data-line\":\"\",children:[n(s.span,{style:{color:\"#B392F0\"},children:\"      setLoading\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),n(s.span,{style:{color:\"#79B8FF\"},children:\"false\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\");\"})]}),\"\\n\",n(s.span,{\"data-line\":\"\",children:n(s.span,{style:{color:\"#E1E4E8\"},children:\"    });\"})}),\"\\n\",n(s.span,{\"data-line\":\"\",children:n(s.span,{style:{color:\"#E1E4E8\"},children:\"}, [id]);\"})})]})})}),\"\\n\",n(s.p,{children:\"This approach ensures you can display appropriate feedback to the user while data is being fetched.\"}),\"\\n\",n(s.h2,{id:\"2-avoiding-race-conditions\",children:n(s.a,{className:\"subheading-anchor\",\"aria-label\":\"Link to section\",href:\"#2-avoiding-race-conditions\",children:n(s.strong,{children:\"2. Avoiding Race Conditions\"})})}),\"\\n\",e(s.p,{children:[\"A tricky issue can occur when multiple asynchronous requests are made. For example,\\nif you click a button rapidly twice to change the PokÃ©mon ID, a race condition might happen.\\nThis can cause the UI to display incorrect data because your state with the \",n(s.code,{children:\"id\"}),\" will be out of sync\\nwith the fetch call if the fetch for ID 1 comes second and the fetch for ID 2 comes first by happenstance.\"]}),\"\\n\",n(s.p,{children:\"Here how you can fix that:\"}),\"\\n\",n(s.figure,{\"data-rehype-pretty-code-figure\":\"\",children:n(s.pre,{style:{backgroundColor:\"#24292e\",color:\"#e1e4e8\"},tabIndex:\"0\",\"data-language\":\"js\",\"data-theme\":\"github-dark\",children:e(s.code,{\"data-language\":\"js\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:[e(s.span,{\"data-line\":\"\",children:[n(s.span,{style:{color:\"#B392F0\"},children:\"useEffect\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\"(() \"}),n(s.span,{style:{color:\"#F97583\"},children:\"=>\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\" {\"})]}),\"\\n\",e(s.span,{\"data-line\":\"\",\"data-highlighted-line\":\"\",children:[n(s.span,{style:{color:\"#F97583\"},children:\"  let\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\" isMounted \"}),n(s.span,{style:{color:\"#F97583\"},children:\"=\"}),n(s.span,{style:{color:\"#79B8FF\"},children:\" true\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\";\"})]}),\"\\n\",n(s.span,{\"data-line\":\"\",children:\" \"}),\"\\n\",e(s.span,{\"data-line\":\"\",children:[n(s.span,{style:{color:\"#B392F0\"},children:\"  setLoading\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),n(s.span,{style:{color:\"#79B8FF\"},children:\"true\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\");\"})]}),\"\\n\",e(s.span,{\"data-line\":\"\",children:[n(s.span,{style:{color:\"#B392F0\"},children:\"  fetch\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),n(s.span,{style:{color:\"#9ECBFF\"},children:\"`https://pokeapi.co/api/v2/pokemon/${\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\"id\"}),n(s.span,{style:{color:\"#9ECBFF\"},children:\"}`\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\")\"})]}),\"\\n\",e(s.span,{\"data-line\":\"\",children:[n(s.span,{style:{color:\"#E1E4E8\"},children:\"    .\"}),n(s.span,{style:{color:\"#B392F0\"},children:\"then\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\"((\"}),n(s.span,{style:{color:\"#FFAB70\"},children:\"response\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\") \"}),n(s.span,{style:{color:\"#F97583\"},children:\"=>\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\" response.\"}),n(s.span,{style:{color:\"#B392F0\"},children:\"json\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\"())\"})]}),\"\\n\",e(s.span,{\"data-line\":\"\",children:[n(s.span,{style:{color:\"#E1E4E8\"},children:\"    .\"}),n(s.span,{style:{color:\"#B392F0\"},children:\"then\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\"((\"}),n(s.span,{style:{color:\"#FFAB70\"},children:\"data\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\") \"}),n(s.span,{style:{color:\"#F97583\"},children:\"=>\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\" {\"})]}),\"\\n\",e(s.span,{\"data-line\":\"\",\"data-highlighted-line\":\"\",children:[n(s.span,{style:{color:\"#F97583\"},children:\"      if\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\" (isMounted) {\"})]}),\"\\n\",e(s.span,{\"data-line\":\"\",children:[n(s.span,{style:{color:\"#B392F0\"},children:\"        setPokemon\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\"(data);\"})]}),\"\\n\",n(s.span,{\"data-line\":\"\",children:n(s.span,{style:{color:\"#E1E4E8\"},children:\"      }\"})}),\"\\n\",e(s.span,{\"data-line\":\"\",children:[n(s.span,{style:{color:\"#B392F0\"},children:\"      setLoading\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),n(s.span,{style:{color:\"#79B8FF\"},children:\"false\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\");\"})]}),\"\\n\",n(s.span,{\"data-line\":\"\",children:n(s.span,{style:{color:\"#E1E4E8\"},children:\"    })\"})}),\"\\n\",e(s.span,{\"data-line\":\"\",children:[n(s.span,{style:{color:\"#E1E4E8\"},children:\"    .\"}),n(s.span,{style:{color:\"#B392F0\"},children:\"catch\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\"((\"}),n(s.span,{style:{color:\"#FFAB70\"},children:\"error\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\") \"}),n(s.span,{style:{color:\"#F97583\"},children:\"=>\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\" {\"})]}),\"\\n\",e(s.span,{\"data-line\":\"\",children:[n(s.span,{style:{color:\"#F97583\"},children:\"      if\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\" (isMounted) {\"})]}),\"\\n\",e(s.span,{\"data-line\":\"\",children:[n(s.span,{style:{color:\"#B392F0\"},children:\"        setError\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\"(error);\"})]}),\"\\n\",n(s.span,{\"data-line\":\"\",children:n(s.span,{style:{color:\"#E1E4E8\"},children:\"      }\"})}),\"\\n\",e(s.span,{\"data-line\":\"\",children:[n(s.span,{style:{color:\"#B392F0\"},children:\"      setLoading\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),n(s.span,{style:{color:\"#79B8FF\"},children:\"false\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\");\"})]}),\"\\n\",n(s.span,{\"data-line\":\"\",children:n(s.span,{style:{color:\"#E1E4E8\"},children:\"    });\"})}),\"\\n\",n(s.span,{\"data-line\":\"\",children:\" \"}),\"\\n\",e(s.span,{\"data-line\":\"\",\"data-highlighted-line\":\"\",children:[n(s.span,{style:{color:\"#F97583\"},children:\"  return\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\" () \"}),n(s.span,{style:{color:\"#F97583\"},children:\"=>\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\" {\"})]}),\"\\n\",e(s.span,{\"data-line\":\"\",\"data-highlighted-line\":\"\",children:[n(s.span,{style:{color:\"#E1E4E8\"},children:\"    isMounted \"}),n(s.span,{style:{color:\"#F97583\"},children:\"=\"}),n(s.span,{style:{color:\"#79B8FF\"},children:\" false\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\";\"})]}),\"\\n\",n(s.span,{\"data-line\":\"\",\"data-highlighted-line\":\"\",children:n(s.span,{style:{color:\"#E1E4E8\"},children:\"  };\"})}),\"\\n\",n(s.span,{\"data-line\":\"\",children:n(s.span,{style:{color:\"#E1E4E8\"},children:\"}, [id]);\"})})]})})}),\"\\n\",e(s.p,{children:[\"I've written a full blog explaining race conditions, and I highly recommend checking it out:\",n(o,{target:\"\\\\_blank\",href:\"/blog/race-condition-react\",children:\" Race Condition\"}),\".\"]}),\"\\n\",n(s.h2,{id:\"3-abstracting-data-fetching-logic\",children:n(s.a,{className:\"subheading-anchor\",\"aria-label\":\"Link to section\",href:\"#3-abstracting-data-fetching-logic\",children:n(s.strong,{children:\"3. Abstracting Data Fetching Logic\"})})}),\"\\n\",n(s.p,{children:\"If you try to push that code to production, someone will definitely ask, 'Can you just hook it up as a custom hook?' ðŸª\\nand you'll finish with code like this:\"}),\"\\n\",n(s.figure,{\"data-rehype-pretty-code-figure\":\"\",children:n(s.pre,{style:{backgroundColor:\"#24292e\",color:\"#e1e4e8\"},tabIndex:\"0\",\"data-language\":\"js\",\"data-theme\":\"github-dark\",children:e(s.code,{\"data-line-numbers\":\"\",\"data-language\":\"js\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},\"data-line-numbers-max-digits\":\"2\",children:[e(s.span,{\"data-line\":\"\",children:[n(s.span,{style:{color:\"#F97583\"},children:\"const\"}),n(s.span,{style:{color:\"#B392F0\"},children:\" usePokemon\"}),n(s.span,{style:{color:\"#F97583\"},children:\" =\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\" (\"}),n(s.span,{style:{color:\"#FFAB70\"},children:\"id\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\") \"}),n(s.span,{style:{color:\"#F97583\"},children:\"=>\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\" {\"})]}),\"\\n\",e(s.span,{\"data-line\":\"\",children:[n(s.span,{style:{color:\"#F97583\"},children:\"  const\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\" [\"}),n(s.span,{style:{color:\"#79B8FF\"},children:\"id\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\", \"}),n(s.span,{style:{color:\"#79B8FF\"},children:\"setId\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\"] \"}),n(s.span,{style:{color:\"#F97583\"},children:\"=\"}),n(s.span,{style:{color:\"#B392F0\"},children:\" useState\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),n(s.span,{style:{color:\"#79B8FF\"},children:\"1\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\");\"})]}),\"\\n\",e(s.span,{\"data-line\":\"\",children:[n(s.span,{style:{color:\"#F97583\"},children:\"  const\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\" [\"}),n(s.span,{style:{color:\"#79B8FF\"},children:\"pokemon\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\", \"}),n(s.span,{style:{color:\"#79B8FF\"},children:\"setPokemon\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\"] \"}),n(s.span,{style:{color:\"#F97583\"},children:\"=\"}),n(s.span,{style:{color:\"#B392F0\"},children:\" useState\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),n(s.span,{style:{color:\"#79B8FF\"},children:\"null\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\");\"})]}),\"\\n\",e(s.span,{\"data-line\":\"\",children:[n(s.span,{style:{color:\"#F97583\"},children:\"  const\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\" [\"}),n(s.span,{style:{color:\"#79B8FF\"},children:\"loading\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\", \"}),n(s.span,{style:{color:\"#79B8FF\"},children:\"setLoading\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\"] \"}),n(s.span,{style:{color:\"#F97583\"},children:\"=\"}),n(s.span,{style:{color:\"#B392F0\"},children:\" useState\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),n(s.span,{style:{color:\"#79B8FF\"},children:\"false\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\");\"})]}),\"\\n\",e(s.span,{\"data-line\":\"\",children:[n(s.span,{style:{color:\"#F97583\"},children:\"  const\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\" [\"}),n(s.span,{style:{color:\"#79B8FF\"},children:\"error\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\", \"}),n(s.span,{style:{color:\"#79B8FF\"},children:\"setError\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\"] \"}),n(s.span,{style:{color:\"#F97583\"},children:\"=\"}),n(s.span,{style:{color:\"#B392F0\"},children:\" useState\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),n(s.span,{style:{color:\"#79B8FF\"},children:\"null\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\");\"})]}),\"\\n\",n(s.span,{\"data-line\":\"\",children:\" \"}),\"\\n\",e(s.span,{\"data-line\":\"\",children:[n(s.span,{style:{color:\"#B392F0\"},children:\"  useEffect\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\"(() \"}),n(s.span,{style:{color:\"#F97583\"},children:\"=>\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\" {\"})]}),\"\\n\",e(s.span,{\"data-line\":\"\",children:[n(s.span,{style:{color:\"#F97583\"},children:\"    let\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\" isMounted \"}),n(s.span,{style:{color:\"#F97583\"},children:\"=\"}),n(s.span,{style:{color:\"#79B8FF\"},children:\" true\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\";\"})]}),\"\\n\",n(s.span,{\"data-line\":\"\",children:\" \"}),\"\\n\",e(s.span,{\"data-line\":\"\",children:[n(s.span,{style:{color:\"#B392F0\"},children:\"    setLoading\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),n(s.span,{style:{color:\"#79B8FF\"},children:\"true\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\");\"})]}),\"\\n\",e(s.span,{\"data-line\":\"\",children:[n(s.span,{style:{color:\"#B392F0\"},children:\"    fetch\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),n(s.span,{style:{color:\"#9ECBFF\"},children:\"`https://pokeapi.co/api/v2/pokemon/${\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\"id\"}),n(s.span,{style:{color:\"#9ECBFF\"},children:\"}`\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\")\"})]}),\"\\n\",e(s.span,{\"data-line\":\"\",children:[n(s.span,{style:{color:\"#E1E4E8\"},children:\"      .\"}),n(s.span,{style:{color:\"#B392F0\"},children:\"then\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\"((\"}),n(s.span,{style:{color:\"#FFAB70\"},children:\"response\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\") \"}),n(s.span,{style:{color:\"#F97583\"},children:\"=>\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\" response.\"}),n(s.span,{style:{color:\"#B392F0\"},children:\"json\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\"())\"})]}),\"\\n\",e(s.span,{\"data-line\":\"\",children:[n(s.span,{style:{color:\"#E1E4E8\"},children:\"      .\"}),n(s.span,{style:{color:\"#B392F0\"},children:\"then\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\"((\"}),n(s.span,{style:{color:\"#FFAB70\"},children:\"data\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\") \"}),n(s.span,{style:{color:\"#F97583\"},children:\"=>\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\" {\"})]}),\"\\n\",e(s.span,{\"data-line\":\"\",children:[n(s.span,{style:{color:\"#F97583\"},children:\"        if\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\" (isMounted) {\"})]}),\"\\n\",e(s.span,{\"data-line\":\"\",children:[n(s.span,{style:{color:\"#B392F0\"},children:\"          setPokemon\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\"(data);\"})]}),\"\\n\",n(s.span,{\"data-line\":\"\",children:n(s.span,{style:{color:\"#E1E4E8\"},children:\"        }\"})}),\"\\n\",e(s.span,{\"data-line\":\"\",children:[n(s.span,{style:{color:\"#B392F0\"},children:\"        setLoading\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),n(s.span,{style:{color:\"#79B8FF\"},children:\"false\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\");\"})]}),\"\\n\",n(s.span,{\"data-line\":\"\",children:n(s.span,{style:{color:\"#E1E4E8\"},children:\"      })\"})}),\"\\n\",e(s.span,{\"data-line\":\"\",children:[n(s.span,{style:{color:\"#E1E4E8\"},children:\"      .\"}),n(s.span,{style:{color:\"#B392F0\"},children:\"catch\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\"((\"}),n(s.span,{style:{color:\"#FFAB70\"},children:\"error\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\") \"}),n(s.span,{style:{color:\"#F97583\"},children:\"=>\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\" {\"})]}),\"\\n\",e(s.span,{\"data-line\":\"\",children:[n(s.span,{style:{color:\"#F97583\"},children:\"        if\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\" (isMounted) {\"})]}),\"\\n\",e(s.span,{\"data-line\":\"\",children:[n(s.span,{style:{color:\"#B392F0\"},children:\"          setError\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\"(error);\"})]}),\"\\n\",n(s.span,{\"data-line\":\"\",children:n(s.span,{style:{color:\"#E1E4E8\"},children:\"        }\"})}),\"\\n\",e(s.span,{\"data-line\":\"\",children:[n(s.span,{style:{color:\"#B392F0\"},children:\"        setLoading\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),n(s.span,{style:{color:\"#79B8FF\"},children:\"false\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\");\"})]}),\"\\n\",n(s.span,{\"data-line\":\"\",children:n(s.span,{style:{color:\"#E1E4E8\"},children:\"      });\"})}),\"\\n\",n(s.span,{\"data-line\":\"\",children:\" \"}),\"\\n\",e(s.span,{\"data-line\":\"\",children:[n(s.span,{style:{color:\"#F97583\"},children:\"    return\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\" () \"}),n(s.span,{style:{color:\"#F97583\"},children:\"=>\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\" {\"})]}),\"\\n\",e(s.span,{\"data-line\":\"\",children:[n(s.span,{style:{color:\"#E1E4E8\"},children:\"      isMounted \"}),n(s.span,{style:{color:\"#F97583\"},children:\"=\"}),n(s.span,{style:{color:\"#79B8FF\"},children:\" false\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\";\"})]}),\"\\n\",n(s.span,{\"data-line\":\"\",children:n(s.span,{style:{color:\"#E1E4E8\"},children:\"    };\"})}),\"\\n\",n(s.span,{\"data-line\":\"\",children:n(s.span,{style:{color:\"#E1E4E8\"},children:\"  }, [id]);\"})}),\"\\n\",n(s.span,{\"data-line\":\"\",children:\" \"}),\"\\n\",e(s.span,{\"data-line\":\"\",children:[n(s.span,{style:{color:\"#F97583\"},children:\"  return\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\" { pokemon, loading, error };\"})]}),\"\\n\",n(s.span,{\"data-line\":\"\",children:n(s.span,{style:{color:\"#E1E4E8\"},children:\"};\"})})]})})}),\"\\n\",n(s.p,{children:\"This hook encapsulates the data fetching logic, making it reusable across different components.\"}),\"\\n\",n(s.h2,{id:\"4-managing-data-duplication-and-state\",children:n(s.a,{className:\"subheading-anchor\",\"aria-label\":\"Link to section\",href:\"#4-managing-data-duplication-and-state\",children:n(s.strong,{children:\"4. Managing Data Duplication and State\"})})}),\"\\n\",n(s.p,{children:\"Okay, after addressing all the previous issues,\\nyou might realize that another component also needs access to the same endpoint data.\\nIt wouldn't make sense to send another request to the backend just to get the same results.\\nRemember, one of your key responsibilities as a software developer is to\\nreduce unnecessary costs and inefficiencies in your code.\"}),\"\\n\",n(s.p,{children:\"When multiple components fetch the same data, it not only creates redundant requests but can also lead to inconsistencies.\\nTo prevent this, you should create a context to share the data across multiple components. Alternatively,\\nyou could lift the state up to a common parent component or use context to efficiently manage and distribute the data.\"}),\"\\n\",n(s.figure,{\"data-rehype-pretty-code-figure\":\"\",children:n(s.pre,{style:{backgroundColor:\"#24292e\",color:\"#e1e4e8\"},tabIndex:\"0\",\"data-language\":\"js\",\"data-theme\":\"github-dark\",children:e(s.code,{\"data-language\":\"js\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:[e(s.span,{\"data-line\":\"\",children:[n(s.span,{style:{color:\"#F97583\"},children:\"import\"}),n(s.span,{style:{color:\"#79B8FF\"},children:\" *\"}),n(s.span,{style:{color:\"#F97583\"},children:\" as\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\" React \"}),n(s.span,{style:{color:\"#F97583\"},children:\"from\"}),n(s.span,{style:{color:\"#9ECBFF\"},children:' \"react\"'}),n(s.span,{style:{color:\"#E1E4E8\"},children:\";\"})]}),\"\\n\",n(s.span,{\"data-line\":\"\",children:\" \"}),\"\\n\",e(s.span,{\"data-line\":\"\",children:[n(s.span,{style:{color:\"#F97583\"},children:\"const\"}),n(s.span,{style:{color:\"#79B8FF\"},children:\" queryContext\"}),n(s.span,{style:{color:\"#F97583\"},children:\" =\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\" React.\"}),n(s.span,{style:{color:\"#B392F0\"},children:\"createContext\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\"([{}, () \"}),n(s.span,{style:{color:\"#F97583\"},children:\"=>\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\" {}]);\"})]}),\"\\n\",n(s.span,{\"data-line\":\"\",children:\" \"}),\"\\n\",e(s.span,{\"data-line\":\"\",children:[n(s.span,{style:{color:\"#F97583\"},children:\"export\"}),n(s.span,{style:{color:\"#F97583\"},children:\" function\"}),n(s.span,{style:{color:\"#B392F0\"},children:\" QueryProvider\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\"({ \"}),n(s.span,{style:{color:\"#FFAB70\"},children:\"children\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\" }) {\"})]}),\"\\n\",e(s.span,{\"data-line\":\"\",children:[n(s.span,{style:{color:\"#F97583\"},children:\"  const\"}),n(s.span,{style:{color:\"#79B8FF\"},children:\" tuple\"}),n(s.span,{style:{color:\"#F97583\"},children:\" =\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\" React.\"}),n(s.span,{style:{color:\"#B392F0\"},children:\"useState\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\"({});\"})]}),\"\\n\",n(s.span,{\"data-line\":\"\",children:\" \"}),\"\\n\",e(s.span,{\"data-line\":\"\",children:[n(s.span,{style:{color:\"#F97583\"},children:\"  return\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\" (\"})]}),\"\\n\",e(s.span,{\"data-line\":\"\",children:[n(s.span,{style:{color:\"#E1E4E8\"},children:\"    <\"}),n(s.span,{style:{color:\"#79B8FF\"},children:\"queryContext.Provider\"}),n(s.span,{style:{color:\"#B392F0\"},children:\" value\"}),n(s.span,{style:{color:\"#F97583\"},children:\"=\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\"{tuple}>{children}</\"}),n(s.span,{style:{color:\"#79B8FF\"},children:\"queryContext.Provider\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\">\"})]}),\"\\n\",n(s.span,{\"data-line\":\"\",children:n(s.span,{style:{color:\"#E1E4E8\"},children:\"  );\"})}),\"\\n\",n(s.span,{\"data-line\":\"\",children:n(s.span,{style:{color:\"#E1E4E8\"},children:\"}\"})}),\"\\n\",n(s.span,{\"data-line\":\"\",children:\" \"}),\"\\n\",e(s.span,{\"data-line\":\"\",children:[n(s.span,{style:{color:\"#F97583\"},children:\"export\"}),n(s.span,{style:{color:\"#F97583\"},children:\" default\"}),n(s.span,{style:{color:\"#F97583\"},children:\" function\"}),n(s.span,{style:{color:\"#B392F0\"},children:\" useQuery\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),n(s.span,{style:{color:\"#FFAB70\"},children:\"url\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\") {\"})]}),\"\\n\",e(s.span,{\"data-line\":\"\",children:[n(s.span,{style:{color:\"#F97583\"},children:\"  const\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\" [\"}),n(s.span,{style:{color:\"#79B8FF\"},children:\"state\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\", \"}),n(s.span,{style:{color:\"#79B8FF\"},children:\"setState\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\"] \"}),n(s.span,{style:{color:\"#F97583\"},children:\"=\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\" React.\"}),n(s.span,{style:{color:\"#B392F0\"},children:\"useContext\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\"(queryContext);\"})]}),\"\\n\",n(s.span,{\"data-line\":\"\",children:\" \"}),\"\\n\",e(s.span,{\"data-line\":\"\",children:[n(s.span,{style:{color:\"#E1E4E8\"},children:\"  React.\"}),n(s.span,{style:{color:\"#B392F0\"},children:\"useEffect\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\"(() \"}),n(s.span,{style:{color:\"#F97583\"},children:\"=>\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\" {\"})]}),\"\\n\",e(s.span,{\"data-line\":\"\",children:[n(s.span,{style:{color:\"#F97583\"},children:\"    const\"}),n(s.span,{style:{color:\"#B392F0\"},children:\" update\"}),n(s.span,{style:{color:\"#F97583\"},children:\" =\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\" (\"}),n(s.span,{style:{color:\"#FFAB70\"},children:\"newState\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\") \"}),n(s.span,{style:{color:\"#F97583\"},children:\"=>\"})]}),\"\\n\",e(s.span,{\"data-line\":\"\",children:[n(s.span,{style:{color:\"#B392F0\"},children:\"      setState\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\"((\"}),n(s.span,{style:{color:\"#FFAB70\"},children:\"prevState\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\") \"}),n(s.span,{style:{color:\"#F97583\"},children:\"=>\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\" ({\"})]}),\"\\n\",e(s.span,{\"data-line\":\"\",children:[n(s.span,{style:{color:\"#F97583\"},children:\"        ...\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\"prevState,\"})]}),\"\\n\",e(s.span,{\"data-line\":\"\",children:[n(s.span,{style:{color:\"#E1E4E8\"},children:\"        [url]: { \"}),n(s.span,{style:{color:\"#F97583\"},children:\"...\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\"prevState[url], \"}),n(s.span,{style:{color:\"#F97583\"},children:\"...\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\"newState },\"})]}),\"\\n\",n(s.span,{\"data-line\":\"\",children:n(s.span,{style:{color:\"#E1E4E8\"},children:\"      }));\"})}),\"\\n\",e(s.span,{\"data-line\":\"\",children:[n(s.span,{style:{color:\"#F97583\"},children:\"    let\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\" ignore \"}),n(s.span,{style:{color:\"#F97583\"},children:\"=\"}),n(s.span,{style:{color:\"#79B8FF\"},children:\" false\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\";\"})]}),\"\\n\",n(s.span,{\"data-line\":\"\",children:\" \"}),\"\\n\",e(s.span,{\"data-line\":\"\",children:[n(s.span,{style:{color:\"#F97583\"},children:\"    const\"}),n(s.span,{style:{color:\"#B392F0\"},children:\" handleFetch\"}),n(s.span,{style:{color:\"#F97583\"},children:\" =\"}),n(s.span,{style:{color:\"#F97583\"},children:\" async\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\" () \"}),n(s.span,{style:{color:\"#F97583\"},children:\"=>\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\" {\"})]}),\"\\n\",e(s.span,{\"data-line\":\"\",children:[n(s.span,{style:{color:\"#B392F0\"},children:\"      update\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\"({ data: \"}),n(s.span,{style:{color:\"#79B8FF\"},children:\"null\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\", isLoading: \"}),n(s.span,{style:{color:\"#79B8FF\"},children:\"true\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\", error: \"}),n(s.span,{style:{color:\"#79B8FF\"},children:\"null\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\" });\"})]}),\"\\n\",n(s.span,{\"data-line\":\"\",children:\" \"}),\"\\n\",e(s.span,{\"data-line\":\"\",children:[n(s.span,{style:{color:\"#F97583\"},children:\"      try\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\" {\"})]}),\"\\n\",e(s.span,{\"data-line\":\"\",children:[n(s.span,{style:{color:\"#F97583\"},children:\"        const\"}),n(s.span,{style:{color:\"#79B8FF\"},children:\" response\"}),n(s.span,{style:{color:\"#F97583\"},children:\" =\"}),n(s.span,{style:{color:\"#F97583\"},children:\" await\"}),n(s.span,{style:{color:\"#B392F0\"},children:\" fetch\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\"(url);\"})]}),\"\\n\",n(s.span,{\"data-line\":\"\",children:\" \"}),\"\\n\",e(s.span,{\"data-line\":\"\",children:[n(s.span,{style:{color:\"#F97583\"},children:\"        if\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\" (ignore) {\"})]}),\"\\n\",e(s.span,{\"data-line\":\"\",children:[n(s.span,{style:{color:\"#F97583\"},children:\"          return\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\";\"})]}),\"\\n\",n(s.span,{\"data-line\":\"\",children:n(s.span,{style:{color:\"#E1E4E8\"},children:\"        }\"})}),\"\\n\",e(s.span,{\"data-line\":\"\",children:[n(s.span,{style:{color:\"#F97583\"},children:\"        if\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\" (res.ok \"}),n(s.span,{style:{color:\"#F97583\"},children:\"===\"}),n(s.span,{style:{color:\"#79B8FF\"},children:\" false\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\") {\"})]}),\"\\n\",e(s.span,{\"data-line\":\"\",children:[n(s.span,{style:{color:\"#F97583\"},children:\"          throw\"}),n(s.span,{style:{color:\"#F97583\"},children:\" new\"}),n(s.span,{style:{color:\"#B392F0\"},children:\" Error\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),n(s.span,{style:{color:\"#9ECBFF\"},children:'\"Network response was not ok\"'}),n(s.span,{style:{color:\"#E1E4E8\"},children:\");\"})]}),\"\\n\",n(s.span,{\"data-line\":\"\",children:n(s.span,{style:{color:\"#E1E4E8\"},children:\"        }\"})}),\"\\n\",n(s.span,{\"data-line\":\"\",children:\" \"}),\"\\n\",e(s.span,{\"data-line\":\"\",children:[n(s.span,{style:{color:\"#F97583\"},children:\"        const\"}),n(s.span,{style:{color:\"#79B8FF\"},children:\" data\"}),n(s.span,{style:{color:\"#F97583\"},children:\" =\"}),n(s.span,{style:{color:\"#F97583\"},children:\" await\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\" response.\"}),n(s.span,{style:{color:\"#B392F0\"},children:\"json\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\"();\"})]}),\"\\n\",n(s.span,{\"data-line\":\"\",children:\" \"}),\"\\n\",e(s.span,{\"data-line\":\"\",children:[n(s.span,{style:{color:\"#B392F0\"},children:\"        update\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\"({ data, isLoading: \"}),n(s.span,{style:{color:\"#79B8FF\"},children:\"false\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\", error: \"}),n(s.span,{style:{color:\"#79B8FF\"},children:\"null\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\" });\"})]}),\"\\n\",e(s.span,{\"data-line\":\"\",children:[n(s.span,{style:{color:\"#E1E4E8\"},children:\"      } \"}),n(s.span,{style:{color:\"#F97583\"},children:\"catch\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\" (error) {\"})]}),\"\\n\",e(s.span,{\"data-line\":\"\",children:[n(s.span,{style:{color:\"#B392F0\"},children:\"        update\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\"({ data: \"}),n(s.span,{style:{color:\"#79B8FF\"},children:\"null\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\", isLoading: \"}),n(s.span,{style:{color:\"#79B8FF\"},children:\"false\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\", error });\"})]}),\"\\n\",n(s.span,{\"data-line\":\"\",children:n(s.span,{style:{color:\"#E1E4E8\"},children:\"      }\"})}),\"\\n\",n(s.span,{\"data-line\":\"\",children:n(s.span,{style:{color:\"#E1E4E8\"},children:\"    };\"})}),\"\\n\",n(s.span,{\"data-line\":\"\",children:n(s.span,{style:{color:\"#E1E4E8\"},children:\"  }, [url]);\"})}),\"\\n\",n(s.span,{\"data-line\":\"\",children:\" \"}),\"\\n\",e(s.span,{\"data-line\":\"\",children:[n(s.span,{style:{color:\"#F97583\"},children:\"  return\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\" state[url] \"}),n(s.span,{style:{color:\"#F97583\"},children:\"||\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\" { data: \"}),n(s.span,{style:{color:\"#79B8FF\"},children:\"null\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\", isLoading: \"}),n(s.span,{style:{color:\"#79B8FF\"},children:\"true\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\", error: \"}),n(s.span,{style:{color:\"#79B8FF\"},children:\"null\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\" };\"})]}),\"\\n\",n(s.span,{\"data-line\":\"\",children:n(s.span,{style:{color:\"#E1E4E8\"},children:\"}\"})})]})})}),\"\\n\",n(s.p,{children:\"Are you still considering handling asynchronous data by yourself?\\nI don't think so.\"}),\"\\n\",e(s.blockquote,{children:[\"\\n\",n(s.p,{children:\"Before trying to solve a problem by myself,\\nI always check if others have already solved it for us,\\nand in most cases, they have.\\n.\"}),\"\\n\"]}),\"\\n\",n(s.h2,{id:\"5-leveraging-react-query\",children:n(s.a,{className:\"subheading-anchor\",\"aria-label\":\"Link to section\",href:\"#5-leveraging-react-query\",children:n(s.strong,{children:\"5. Leveraging React Query\"})})}),\"\\n\",n(s.p,{children:\"To simplify data fetching and state management, consider using React Query. It efficiently handles caching,\\nsynchronization, and state updates. Look at how easy it is to fetch data without worrying about all the previous issues.\"}),\"\\n\",n(s.figure,{\"data-rehype-pretty-code-figure\":\"\",children:n(s.pre,{style:{backgroundColor:\"#24292e\",color:\"#e1e4e8\"},tabIndex:\"0\",\"data-language\":\"js\",\"data-theme\":\"github-dark\",children:e(s.code,{\"data-line-numbers\":\"\",\"data-language\":\"js\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},\"data-line-numbers-max-digits\":\"2\",children:[e(s.span,{\"data-line\":\"\",children:[n(s.span,{style:{color:\"#F97583\"},children:\"import\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\" { useQuery } \"}),n(s.span,{style:{color:\"#F97583\"},children:\"from\"}),n(s.span,{style:{color:\"#9ECBFF\"},children:' \"@tanstack/react-query\"'}),n(s.span,{style:{color:\"#E1E4E8\"},children:\";\"})]}),\"\\n\",n(s.span,{\"data-line\":\"\",children:\" \"}),\"\\n\",e(s.span,{\"data-line\":\"\",children:[n(s.span,{style:{color:\"#F97583\"},children:\"const\"}),n(s.span,{style:{color:\"#B392F0\"},children:\" fetchPokemon\"}),n(s.span,{style:{color:\"#F97583\"},children:\" =\"}),n(s.span,{style:{color:\"#F97583\"},children:\" async\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\" (\"}),n(s.span,{style:{color:\"#FFAB70\"},children:\"id\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\") \"}),n(s.span,{style:{color:\"#F97583\"},children:\"=>\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\" {\"})]}),\"\\n\",e(s.span,{\"data-line\":\"\",children:[n(s.span,{style:{color:\"#F97583\"},children:\"  const\"}),n(s.span,{style:{color:\"#79B8FF\"},children:\" res\"}),n(s.span,{style:{color:\"#F97583\"},children:\" =\"}),n(s.span,{style:{color:\"#F97583\"},children:\" await\"}),n(s.span,{style:{color:\"#B392F0\"},children:\" fetch\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),n(s.span,{style:{color:\"#9ECBFF\"},children:\"`https://pokeapi.co/api/v2/pokemon/${\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\"id\"}),n(s.span,{style:{color:\"#9ECBFF\"},children:\"}`\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\");\"})]}),\"\\n\",e(s.span,{\"data-line\":\"\",children:[n(s.span,{style:{color:\"#F97583\"},children:\"  if\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\" (\"}),n(s.span,{style:{color:\"#F97583\"},children:\"!\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\"res.ok) \"}),n(s.span,{style:{color:\"#F97583\"},children:\"throw\"}),n(s.span,{style:{color:\"#F97583\"},children:\" new\"}),n(s.span,{style:{color:\"#B392F0\"},children:\" Error\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),n(s.span,{style:{color:\"#9ECBFF\"},children:'\"Network response was not ok\"'}),n(s.span,{style:{color:\"#E1E4E8\"},children:\");\"})]}),\"\\n\",e(s.span,{\"data-line\":\"\",children:[n(s.span,{style:{color:\"#F97583\"},children:\"  return\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\" res.\"}),n(s.span,{style:{color:\"#B392F0\"},children:\"json\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\"();\"})]}),\"\\n\",n(s.span,{\"data-line\":\"\",children:n(s.span,{style:{color:\"#E1E4E8\"},children:\"};\"})}),\"\\n\",n(s.span,{\"data-line\":\"\",children:\" \"}),\"\\n\",e(s.span,{\"data-line\":\"\",children:[n(s.span,{style:{color:\"#F97583\"},children:\"const\"}),n(s.span,{style:{color:\"#B392F0\"},children:\" Pokemon\"}),n(s.span,{style:{color:\"#F97583\"},children:\" =\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\" () \"}),n(s.span,{style:{color:\"#F97583\"},children:\"=>\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\" {\"})]}),\"\\n\",e(s.span,{\"data-line\":\"\",\"data-highlighted-line\":\"\",children:[n(s.span,{style:{color:\"#F97583\"},children:\"  const\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\" [\"}),n(s.span,{style:{color:\"#79B8FF\"},children:\"id\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\", \"}),n(s.span,{style:{color:\"#79B8FF\"},children:\"setId\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\"] \"}),n(s.span,{style:{color:\"#F97583\"},children:\"=\"}),n(s.span,{style:{color:\"#B392F0\"},children:\" useState\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),n(s.span,{style:{color:\"#79B8FF\"},children:\"1\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\");\"})]}),\"\\n\",n(s.span,{\"data-line\":\"\",children:\" \"}),\"\\n\",e(s.span,{\"data-line\":\"\",children:[n(s.span,{style:{color:\"#F97583\"},children:\"  const\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\" { \"}),n(s.span,{style:{color:\"#79B8FF\"},children:\"data\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\", \"}),n(s.span,{style:{color:\"#79B8FF\"},children:\"isLoading\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\", \"}),n(s.span,{style:{color:\"#79B8FF\"},children:\"error\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\" } \"}),n(s.span,{style:{color:\"#F97583\"},children:\"=\"}),n(s.span,{style:{color:\"#B392F0\"},children:\" useQuery\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\"({\"})]}),\"\\n\",e(s.span,{\"data-line\":\"\",children:[n(s.span,{style:{color:\"#E1E4E8\"},children:\"    queryKey: [\"}),n(s.span,{style:{color:\"#9ECBFF\"},children:'\"pokemon\"'}),n(s.span,{style:{color:\"#E1E4E8\"},children:\", id],\"})]}),\"\\n\",e(s.span,{\"data-line\":\"\",children:[n(s.span,{style:{color:\"#B392F0\"},children:\"    queryFn\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\": () \"}),n(s.span,{style:{color:\"#F97583\"},children:\"=>\"}),n(s.span,{style:{color:\"#B392F0\"},children:\" fetchPokemon\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\"(id),\"})]}),\"\\n\",n(s.span,{\"data-line\":\"\",children:n(s.span,{style:{color:\"#E1E4E8\"},children:\"  });\"})}),\"\\n\",n(s.span,{\"data-line\":\"\",children:\" \"}),\"\\n\",e(s.span,{\"data-line\":\"\",children:[n(s.span,{style:{color:\"#F97583\"},children:\"  if\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\" (isLoading) \"}),n(s.span,{style:{color:\"#F97583\"},children:\"return\"}),n(s.span,{style:{color:\"#9ECBFF\"},children:' \"Loading...\"'}),n(s.span,{style:{color:\"#E1E4E8\"},children:\";\"})]}),\"\\n\",e(s.span,{\"data-line\":\"\",children:[n(s.span,{style:{color:\"#F97583\"},children:\"  if\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\" (error) \"}),n(s.span,{style:{color:\"#F97583\"},children:\"return\"}),n(s.span,{style:{color:\"#9ECBFF\"},children:' \"An error has occurred: \"'}),n(s.span,{style:{color:\"#F97583\"},children:\" +\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\" error.message;\"})]}),\"\\n\",n(s.span,{\"data-line\":\"\",children:\" \"}),\"\\n\",e(s.span,{\"data-line\":\"\",children:[n(s.span,{style:{color:\"#F97583\"},children:\"  return\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\" <\"}),n(s.span,{style:{color:\"#85E89D\"},children:\"div\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\">....</\"}),n(s.span,{style:{color:\"#85E89D\"},children:\"div\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\">;\"})]}),\"\\n\",n(s.span,{\"data-line\":\"\",children:n(s.span,{style:{color:\"#E1E4E8\"},children:\"};\"})}),\"\\n\",n(s.span,{\"data-line\":\"\",children:\" \"}),\"\\n\",e(s.span,{\"data-line\":\"\",children:[n(s.span,{style:{color:\"#F97583\"},children:\"export\"}),n(s.span,{style:{color:\"#F97583\"},children:\" default\"}),n(s.span,{style:{color:\"#E1E4E8\"},children:\" Pokemon;\"})]})]})})}),\"\\n\",n(s.p,{children:\"React Query abstracts away much of the complexity involved in handling asynchronous data and state, allowing you to focus on building features.\"}),\"\\n\",n(s.h2,{id:\"conclusion\",children:n(s.a,{className:\"subheading-anchor\",\"aria-label\":\"Link to section\",href:\"#conclusion\",children:n(s.strong,{children:\"Conclusion\"})})}),\"\\n\",n(s.p,{children:\"Asynchronous data fetching in React requires careful consideration beyond just making API calls. To build reliable and efficient applications, itâ€™s crucial to:\"}),\"\\n\",e(s.ul,{children:[\"\\n\",e(s.li,{children:[n(s.strong,{children:\"Handle loading and error states effectively\"}),\" to provide a smooth user experience.\"]}),\"\\n\",e(s.li,{children:[n(s.strong,{children:\"Avoid race conditions\"}),\" to ensure the UI always reflects the most current data.\"]}),\"\\n\",e(s.li,{children:[n(s.strong,{children:\"Abstract fetching logic into reusable hooks\"}),\" for cleaner and more maintainable code.\"]}),\"\\n\",e(s.li,{children:[n(s.strong,{children:\"Manage state duplication\"}),\" to prevent redundant requests and ensure data consistency across components.\"]}),\"\\n\",e(s.li,{children:[n(s.strong,{children:\"Leverage tools like React Query\"}),\" to simplify data fetching and state management.\"]}),\"\\n\"]}),\"\\n\",n(s.p,{children:\"By addressing these areas, you'll not only improve the robustness of your applications but also enhance the overall user experience, making your React apps more performant and user-friendly.\"})]})}return{default:function(l={}){const{wrapper:e}=l.components||{};return e?n(e,{...l,children:n(_createMdxContent,{...l})}):_createMdxContent(l)}};",
    "slugAsParams": "handling-asyc-data"
  },
  {
    "slug": "blog/race-condition-react",
    "title": "How to fix race condition in React",
    "description": "Fixing race condition in React with useEffect",
    "date": "2024-08-06T00:00:00.000Z",
    "published": true,
    "tags": [
      "react js",
      "useEffect"
    ],
    "body": "const{Fragment:e,jsx:n,jsxs:l}=arguments[0];function _createMdxContent(r){const c={a:\"a\",blockquote:\"blockquote\",code:\"code\",figure:\"figure\",h2:\"h2\",li:\"li\",p:\"p\",pre:\"pre\",span:\"span\",ul:\"ul\",...r.components};return l(e,{children:[l(c.p,{children:[\"Imagine you have a React component that fetches data based on an \",n(c.code,{children:\"id\"}),\" prop.\\nThe component uses useEffect to fetch the data whenever the \",n(c.code,{children:\"id\"}),\" changes, and then displays the results.\"]}),\"\\n\",n(c.p,{children:\"However, you've noticed something odd: sometimes the data shown is accurate, but other times it's incorrect or outdated.\"}),\"\\n\",n(c.p,{children:\"This inconsistency is likely due to a race condition.\"}),\"\\n\",n(c.p,{children:\"In React, a race condition often occurs when two similar data requests are made, and the result displayed depends on which request finishes first.\"}),\"\\n\",l(c.p,{children:[\"In this case, if the \",n(c.code,{children:\"id prop\"}),\" changes quickly enough, the useEffect hook might trigger a race condition in the component's data fetching logic.\"]}),\"\\n\",n(c.figure,{\"data-rehype-pretty-code-figure\":\"\",children:n(c.pre,{style:{backgroundColor:\"#24292e\",color:\"#e1e4e8\"},tabIndex:\"0\",\"data-language\":\"js\",\"data-theme\":\"github-dark\",children:l(c.code,{\"data-language\":\"js\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:[l(c.span,{\"data-line\":\"\",children:[n(c.span,{style:{color:\"#F97583\"},children:\"import\"}),n(c.span,{style:{color:\"#E1E4E8\"},children:\" React, { useEffect, useState } \"}),n(c.span,{style:{color:\"#F97583\"},children:\"from\"}),n(c.span,{style:{color:\"#9ECBFF\"},children:' \"react\"'}),n(c.span,{style:{color:\"#E1E4E8\"},children:\";\"})]}),\"\\n\",n(c.span,{\"data-line\":\"\",children:\" \"}),\"\\n\",l(c.span,{\"data-line\":\"\",children:[n(c.span,{style:{color:\"#F97583\"},children:\"export\"}),n(c.span,{style:{color:\"#F97583\"},children:\" default\"}),n(c.span,{style:{color:\"#F97583\"},children:\" function\"}),n(c.span,{style:{color:\"#B392F0\"},children:\" DataDisplayer\"}),n(c.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),n(c.span,{style:{color:\"#FFAB70\"},children:\"props\"}),n(c.span,{style:{color:\"#E1E4E8\"},children:\") {\"})]}),\"\\n\",l(c.span,{\"data-line\":\"\",children:[n(c.span,{style:{color:\"#F97583\"},children:\"  const\"}),n(c.span,{style:{color:\"#E1E4E8\"},children:\" [\"}),n(c.span,{style:{color:\"#79B8FF\"},children:\"data\"}),n(c.span,{style:{color:\"#E1E4E8\"},children:\", \"}),n(c.span,{style:{color:\"#79B8FF\"},children:\"setData\"}),n(c.span,{style:{color:\"#E1E4E8\"},children:\"] \"}),n(c.span,{style:{color:\"#F97583\"},children:\"=\"}),n(c.span,{style:{color:\"#B392F0\"},children:\" useState\"}),n(c.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),n(c.span,{style:{color:\"#79B8FF\"},children:\"null\"}),n(c.span,{style:{color:\"#E1E4E8\"},children:\");\"})]}),\"\\n\",n(c.span,{\"data-line\":\"\",children:\" \"}),\"\\n\",l(c.span,{\"data-line\":\"\",children:[n(c.span,{style:{color:\"#B392F0\"},children:\"  useEffect\"}),n(c.span,{style:{color:\"#E1E4E8\"},children:\"(() \"}),n(c.span,{style:{color:\"#F97583\"},children:\"=>\"}),n(c.span,{style:{color:\"#E1E4E8\"},children:\" {\"})]}),\"\\n\",l(c.span,{\"data-line\":\"\",children:[n(c.span,{style:{color:\"#F97583\"},children:\"    const\"}),n(c.span,{style:{color:\"#B392F0\"},children:\" fetchData\"}),n(c.span,{style:{color:\"#F97583\"},children:\" =\"}),n(c.span,{style:{color:\"#F97583\"},children:\" async\"}),n(c.span,{style:{color:\"#E1E4E8\"},children:\" () \"}),n(c.span,{style:{color:\"#F97583\"},children:\"=>\"}),n(c.span,{style:{color:\"#E1E4E8\"},children:\" {\"})]}),\"\\n\",l(c.span,{\"data-line\":\"\",children:[n(c.span,{style:{color:\"#F97583\"},children:\"      const\"}),n(c.span,{style:{color:\"#79B8FF\"},children:\" response\"}),n(c.span,{style:{color:\"#F97583\"},children:\" =\"}),n(c.span,{style:{color:\"#F97583\"},children:\" await\"}),n(c.span,{style:{color:\"#B392F0\"},children:\" fetch\"}),n(c.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),n(c.span,{style:{color:\"#9ECBFF\"},children:\"`https://swapi.dev/api/people/${\"}),n(c.span,{style:{color:\"#E1E4E8\"},children:\"props\"}),n(c.span,{style:{color:\"#9ECBFF\"},children:\".\"}),n(c.span,{style:{color:\"#E1E4E8\"},children:\"id\"}),n(c.span,{style:{color:\"#9ECBFF\"},children:\"}/`\"}),n(c.span,{style:{color:\"#E1E4E8\"},children:\");\"})]}),\"\\n\",l(c.span,{\"data-line\":\"\",children:[n(c.span,{style:{color:\"#F97583\"},children:\"      const\"}),n(c.span,{style:{color:\"#79B8FF\"},children:\" newData\"}),n(c.span,{style:{color:\"#F97583\"},children:\" =\"}),n(c.span,{style:{color:\"#F97583\"},children:\" await\"}),n(c.span,{style:{color:\"#E1E4E8\"},children:\" response.\"}),n(c.span,{style:{color:\"#B392F0\"},children:\"json\"}),n(c.span,{style:{color:\"#E1E4E8\"},children:\"();\"})]}),\"\\n\",l(c.span,{\"data-line\":\"\",children:[n(c.span,{style:{color:\"#B392F0\"},children:\"      setData\"}),n(c.span,{style:{color:\"#E1E4E8\"},children:\"(newData);\"})]}),\"\\n\",n(c.span,{\"data-line\":\"\",children:n(c.span,{style:{color:\"#E1E4E8\"},children:\"    };\"})}),\"\\n\",n(c.span,{\"data-line\":\"\",children:\" \"}),\"\\n\",l(c.span,{\"data-line\":\"\",children:[n(c.span,{style:{color:\"#B392F0\"},children:\"    fetchData\"}),n(c.span,{style:{color:\"#E1E4E8\"},children:\"();\"})]}),\"\\n\",n(c.span,{\"data-line\":\"\",children:n(c.span,{style:{color:\"#E1E4E8\"},children:\"  }, [props.id]);\"})}),\"\\n\",n(c.span,{\"data-line\":\"\",children:\" \"}),\"\\n\",l(c.span,{\"data-line\":\"\",children:[n(c.span,{style:{color:\"#F97583\"},children:\"  if\"}),n(c.span,{style:{color:\"#E1E4E8\"},children:\" (data) {\"})]}),\"\\n\",l(c.span,{\"data-line\":\"\",children:[n(c.span,{style:{color:\"#F97583\"},children:\"    return\"}),n(c.span,{style:{color:\"#E1E4E8\"},children:\" <\"}),n(c.span,{style:{color:\"#85E89D\"},children:\"div\"}),n(c.span,{style:{color:\"#E1E4E8\"},children:\">{data.name}</\"}),n(c.span,{style:{color:\"#85E89D\"},children:\"div\"}),n(c.span,{style:{color:\"#E1E4E8\"},children:\">;\"})]}),\"\\n\",l(c.span,{\"data-line\":\"\",children:[n(c.span,{style:{color:\"#E1E4E8\"},children:\"  } \"}),n(c.span,{style:{color:\"#F97583\"},children:\"else\"}),n(c.span,{style:{color:\"#E1E4E8\"},children:\" {\"})]}),\"\\n\",l(c.span,{\"data-line\":\"\",children:[n(c.span,{style:{color:\"#F97583\"},children:\"    return\"}),n(c.span,{style:{color:\"#79B8FF\"},children:\" null\"}),n(c.span,{style:{color:\"#E1E4E8\"},children:\";\"})]}),\"\\n\",n(c.span,{\"data-line\":\"\",children:n(c.span,{style:{color:\"#E1E4E8\"},children:\"  }\"})}),\"\\n\",n(c.span,{\"data-line\":\"\",children:n(c.span,{style:{color:\"#E1E4E8\"},children:\"}\"})})]})})}),\"\\n\",l(c.p,{children:[\"It might not be immediately clear that the above code is prone to race conditions,\\nso I created a \",n(c.a,{href:\"https://rb.gy/virx7o\",children:\"CodeSandbox\"}),\" to make it more apparent. In this example, I added a random delay of up to 12 seconds per request.\"]}),\"\\n\",n(c.p,{children:'You can observe the intended behavior by clicking the \"Fetch data!\" button once. The component will simply display the data in response to the click.'}),\"\\n\",n(c.p,{children:'However, things become more complex if you click the \"Fetch data!\" button rapidly multiple times.\\nThe app will send out several requests, which may finish in a random order. The data from the last request to complete will be the one that gets displayed.'}),\"\\n\",n(c.p,{children:\"Hereâ€™s how the updated DataDisplayer component looks now:\"}),\"\\n\",n(c.figure,{\"data-rehype-pretty-code-figure\":\"\",children:n(c.pre,{style:{backgroundColor:\"#24292e\",color:\"#e1e4e8\"},tabIndex:\"0\",\"data-language\":\"js\",\"data-theme\":\"github-dark\",children:l(c.code,{\"data-language\":\"js\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:[l(c.span,{\"data-line\":\"\",children:[n(c.span,{style:{color:\"#F97583\"},children:\"export\"}),n(c.span,{style:{color:\"#F97583\"},children:\" default\"}),n(c.span,{style:{color:\"#F97583\"},children:\" function\"}),n(c.span,{style:{color:\"#B392F0\"},children:\" DataDisplayer\"}),n(c.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),n(c.span,{style:{color:\"#FFAB70\"},children:\"props\"}),n(c.span,{style:{color:\"#E1E4E8\"},children:\") {\"})]}),\"\\n\",l(c.span,{\"data-line\":\"\",children:[n(c.span,{style:{color:\"#F97583\"},children:\"  const\"}),n(c.span,{style:{color:\"#E1E4E8\"},children:\" [\"}),n(c.span,{style:{color:\"#79B8FF\"},children:\"data\"}),n(c.span,{style:{color:\"#E1E4E8\"},children:\", \"}),n(c.span,{style:{color:\"#79B8FF\"},children:\"setData\"}),n(c.span,{style:{color:\"#E1E4E8\"},children:\"] \"}),n(c.span,{style:{color:\"#F97583\"},children:\"=\"}),n(c.span,{style:{color:\"#B392F0\"},children:\" useState\"}),n(c.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),n(c.span,{style:{color:\"#79B8FF\"},children:\"null\"}),n(c.span,{style:{color:\"#E1E4E8\"},children:\");\"})]}),\"\\n\",l(c.span,{\"data-line\":\"\",children:[n(c.span,{style:{color:\"#F97583\"},children:\"  const\"}),n(c.span,{style:{color:\"#E1E4E8\"},children:\" [\"}),n(c.span,{style:{color:\"#79B8FF\"},children:\"fetchedId\"}),n(c.span,{style:{color:\"#E1E4E8\"},children:\", \"}),n(c.span,{style:{color:\"#79B8FF\"},children:\"setFetchedId\"}),n(c.span,{style:{color:\"#E1E4E8\"},children:\"] \"}),n(c.span,{style:{color:\"#F97583\"},children:\"=\"}),n(c.span,{style:{color:\"#B392F0\"},children:\" useState\"}),n(c.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),n(c.span,{style:{color:\"#79B8FF\"},children:\"null\"}),n(c.span,{style:{color:\"#E1E4E8\"},children:\");\"})]}),\"\\n\",n(c.span,{\"data-line\":\"\",children:\" \"}),\"\\n\",l(c.span,{\"data-line\":\"\",children:[n(c.span,{style:{color:\"#B392F0\"},children:\"  useEffect\"}),n(c.span,{style:{color:\"#E1E4E8\"},children:\"(() \"}),n(c.span,{style:{color:\"#F97583\"},children:\"=>\"}),n(c.span,{style:{color:\"#E1E4E8\"},children:\" {\"})]}),\"\\n\",l(c.span,{\"data-line\":\"\",children:[n(c.span,{style:{color:\"#F97583\"},children:\"    const\"}),n(c.span,{style:{color:\"#B392F0\"},children:\" fetchData\"}),n(c.span,{style:{color:\"#F97583\"},children:\" =\"}),n(c.span,{style:{color:\"#F97583\"},children:\" async\"}),n(c.span,{style:{color:\"#E1E4E8\"},children:\" () \"}),n(c.span,{style:{color:\"#F97583\"},children:\"=>\"}),n(c.span,{style:{color:\"#E1E4E8\"},children:\" {\"})]}),\"\\n\",l(c.span,{\"data-line\":\"\",\"data-highlighted-line\":\"\",children:[n(c.span,{style:{color:\"#B392F0\"},children:\"      setTimeout\"}),n(c.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),n(c.span,{style:{color:\"#F97583\"},children:\"async\"}),n(c.span,{style:{color:\"#E1E4E8\"},children:\" () \"}),n(c.span,{style:{color:\"#F97583\"},children:\"=>\"}),n(c.span,{style:{color:\"#E1E4E8\"},children:\" {\"})]}),\"\\n\",l(c.span,{\"data-line\":\"\",children:[n(c.span,{style:{color:\"#F97583\"},children:\"        const\"}),n(c.span,{style:{color:\"#79B8FF\"},children:\" response\"}),n(c.span,{style:{color:\"#F97583\"},children:\" =\"}),n(c.span,{style:{color:\"#F97583\"},children:\" await\"}),n(c.span,{style:{color:\"#B392F0\"},children:\" fetch\"}),n(c.span,{style:{color:\"#E1E4E8\"},children:\"(\"})]}),\"\\n\",l(c.span,{\"data-line\":\"\",children:[n(c.span,{style:{color:\"#9ECBFF\"},children:\"          `https://swapi.dev/api/people/${\"}),n(c.span,{style:{color:\"#E1E4E8\"},children:\"props\"}),n(c.span,{style:{color:\"#9ECBFF\"},children:\".\"}),n(c.span,{style:{color:\"#E1E4E8\"},children:\"id\"}),n(c.span,{style:{color:\"#9ECBFF\"},children:\"}/`\"})]}),\"\\n\",n(c.span,{\"data-line\":\"\",children:n(c.span,{style:{color:\"#E1E4E8\"},children:\"        );\"})}),\"\\n\",l(c.span,{\"data-line\":\"\",children:[n(c.span,{style:{color:\"#F97583\"},children:\"        const\"}),n(c.span,{style:{color:\"#79B8FF\"},children:\" newData\"}),n(c.span,{style:{color:\"#F97583\"},children:\" =\"}),n(c.span,{style:{color:\"#F97583\"},children:\" await\"}),n(c.span,{style:{color:\"#E1E4E8\"},children:\" response.\"}),n(c.span,{style:{color:\"#B392F0\"},children:\"json\"}),n(c.span,{style:{color:\"#E1E4E8\"},children:\"();\"})]}),\"\\n\",n(c.span,{\"data-line\":\"\",children:\" \"}),\"\\n\",l(c.span,{\"data-line\":\"\",children:[n(c.span,{style:{color:\"#B392F0\"},children:\"        setFetchedId\"}),n(c.span,{style:{color:\"#E1E4E8\"},children:\"(props.id);\"})]}),\"\\n\",l(c.span,{\"data-line\":\"\",children:[n(c.span,{style:{color:\"#B392F0\"},children:\"        setData\"}),n(c.span,{style:{color:\"#E1E4E8\"},children:\"(newData);\"})]}),\"\\n\",l(c.span,{\"data-line\":\"\",\"data-highlighted-line\":\"\",children:[n(c.span,{style:{color:\"#E1E4E8\"},children:\"      }, Math.\"}),n(c.span,{style:{color:\"#B392F0\"},children:\"round\"}),n(c.span,{style:{color:\"#E1E4E8\"},children:\"(Math.\"}),n(c.span,{style:{color:\"#B392F0\"},children:\"random\"}),n(c.span,{style:{color:\"#E1E4E8\"},children:\"() \"}),n(c.span,{style:{color:\"#F97583\"},children:\"*\"}),n(c.span,{style:{color:\"#79B8FF\"},children:\" 12000\"}),n(c.span,{style:{color:\"#E1E4E8\"},children:\"));\"})]}),\"\\n\",n(c.span,{\"data-line\":\"\",children:n(c.span,{style:{color:\"#E1E4E8\"},children:\"    };\"})}),\"\\n\",n(c.span,{\"data-line\":\"\",children:\" \"}),\"\\n\",l(c.span,{\"data-line\":\"\",children:[n(c.span,{style:{color:\"#B392F0\"},children:\"    fetchData\"}),n(c.span,{style:{color:\"#E1E4E8\"},children:\"();\"})]}),\"\\n\",n(c.span,{\"data-line\":\"\",children:n(c.span,{style:{color:\"#E1E4E8\"},children:\"  }, [props.id]);\"})}),\"\\n\",n(c.span,{\"data-line\":\"\",children:\" \"}),\"\\n\",l(c.span,{\"data-line\":\"\",children:[n(c.span,{style:{color:\"#F97583\"},children:\"  if\"}),n(c.span,{style:{color:\"#E1E4E8\"},children:\" (data) {\"})]}),\"\\n\",l(c.span,{\"data-line\":\"\",children:[n(c.span,{style:{color:\"#F97583\"},children:\"    return\"}),n(c.span,{style:{color:\"#E1E4E8\"},children:\" (\"})]}),\"\\n\",l(c.span,{\"data-line\":\"\",children:[n(c.span,{style:{color:\"#E1E4E8\"},children:\"      <\"}),n(c.span,{style:{color:\"#85E89D\"},children:\"div\"}),n(c.span,{style:{color:\"#E1E4E8\"},children:\">\"})]}),\"\\n\",l(c.span,{\"data-line\":\"\",children:[n(c.span,{style:{color:\"#E1E4E8\"},children:\"        <\"}),n(c.span,{style:{color:\"#85E89D\"},children:\"p\"}),n(c.span,{style:{color:\"#B392F0\"},children:\" style\"}),n(c.span,{style:{color:\"#F97583\"},children:\"=\"}),n(c.span,{style:{color:\"#E1E4E8\"},children:\"{{ color: fetchedId \"}),n(c.span,{style:{color:\"#F97583\"},children:\"===\"}),n(c.span,{style:{color:\"#E1E4E8\"},children:\" props.id \"}),n(c.span,{style:{color:\"#F97583\"},children:\"?\"}),n(c.span,{style:{color:\"#9ECBFF\"},children:' \"green\"'}),n(c.span,{style:{color:\"#F97583\"},children:\" :\"}),n(c.span,{style:{color:\"#9ECBFF\"},children:' \"red\"'}),n(c.span,{style:{color:\"#E1E4E8\"},children:\" }}>\"})]}),\"\\n\",n(c.span,{\"data-line\":\"\",children:n(c.span,{style:{color:\"#E1E4E8\"},children:\"          Displaying Data for: {fetchedId}\"})}),\"\\n\",l(c.span,{\"data-line\":\"\",children:[n(c.span,{style:{color:\"#E1E4E8\"},children:\"        </\"}),n(c.span,{style:{color:\"#85E89D\"},children:\"p\"}),n(c.span,{style:{color:\"#E1E4E8\"},children:\">\"})]}),\"\\n\",l(c.span,{\"data-line\":\"\",children:[n(c.span,{style:{color:\"#E1E4E8\"},children:\"        <\"}),n(c.span,{style:{color:\"#85E89D\"},children:\"p\"}),n(c.span,{style:{color:\"#E1E4E8\"},children:\">{data.name}</\"}),n(c.span,{style:{color:\"#85E89D\"},children:\"p\"}),n(c.span,{style:{color:\"#E1E4E8\"},children:\">\"})]}),\"\\n\",l(c.span,{\"data-line\":\"\",children:[n(c.span,{style:{color:\"#E1E4E8\"},children:\"      </\"}),n(c.span,{style:{color:\"#85E89D\"},children:\"div\"}),n(c.span,{style:{color:\"#E1E4E8\"},children:\">\"})]}),\"\\n\",n(c.span,{\"data-line\":\"\",children:n(c.span,{style:{color:\"#E1E4E8\"},children:\"    );\"})}),\"\\n\",l(c.span,{\"data-line\":\"\",children:[n(c.span,{style:{color:\"#E1E4E8\"},children:\"  } \"}),n(c.span,{style:{color:\"#F97583\"},children:\"else\"}),n(c.span,{style:{color:\"#E1E4E8\"},children:\" {\"})]}),\"\\n\",l(c.span,{\"data-line\":\"\",children:[n(c.span,{style:{color:\"#F97583\"},children:\"    return\"}),n(c.span,{style:{color:\"#79B8FF\"},children:\" null\"}),n(c.span,{style:{color:\"#E1E4E8\"},children:\";\"})]}),\"\\n\",n(c.span,{\"data-line\":\"\",children:n(c.span,{style:{color:\"#E1E4E8\"},children:\"  }\"})}),\"\\n\",n(c.span,{\"data-line\":\"\",children:n(c.span,{style:{color:\"#E1E4E8\"},children:\"}\"})})]})})}),\"\\n\",n(c.h2,{id:\"fixing-the-useeffect-race-condition\",children:n(c.a,{className:\"subheading-anchor\",\"aria-label\":\"Link to section\",href:\"#fixing-the-useeffect-race-condition\",children:\"Fixing the useEffect race condition\"})}),\"\\n\",n(c.p,{children:\"There are a couple of approaches we can take here, both taking\\nadvantage of useEffectâ€™s clean-up function:\"}),\"\\n\",l(c.ul,{children:[\"\\n\",l(c.li,{children:[\"\\n\",n(c.p,{children:\"If we're okay with making several requests, but only rendering the last result, we can use a boolean flag.\"}),\"\\n\"]}),\"\\n\",l(c.li,{children:[\"\\n\",l(c.p,{children:[\"Alternatively, if we don't have to support users on Internet Explorer, we can use \",n(c.a,{href:\"https://developer.mozilla.org/en-US/docs/Web/API/AbortController\",children:\"AbortController\"}),\".\"]}),\"\\n\"]}),\"\\n\"]}),\"\\n\",n(c.h2,{id:\"useeffect-clean-up-function-with-boolean-flag\",children:n(c.a,{className:\"subheading-anchor\",\"aria-label\":\"Link to section\",href:\"#useeffect-clean-up-function-with-boolean-flag\",children:\"useEffect Clean-up Function with Boolean Flag\"})}),\"\\n\",n(c.p,{children:\"First, the gist of our fix in code:\"}),\"\\n\",n(c.figure,{\"data-rehype-pretty-code-figure\":\"\",children:n(c.pre,{style:{backgroundColor:\"#24292e\",color:\"#e1e4e8\"},tabIndex:\"0\",\"data-language\":\"js\",\"data-theme\":\"github-dark\",children:l(c.code,{\"data-language\":\"js\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:[l(c.span,{\"data-line\":\"\",children:[n(c.span,{style:{color:\"#B392F0\"},children:\"useEffect\"}),n(c.span,{style:{color:\"#E1E4E8\"},children:\"(() \"}),n(c.span,{style:{color:\"#F97583\"},children:\"=>\"}),n(c.span,{style:{color:\"#E1E4E8\"},children:\" {\"})]}),\"\\n\",l(c.span,{\"data-line\":\"\",\"data-highlighted-line\":\"\",children:[n(c.span,{style:{color:\"#F97583\"},children:\"  let\"}),n(c.span,{style:{color:\"#E1E4E8\"},children:\" active \"}),n(c.span,{style:{color:\"#F97583\"},children:\"=\"}),n(c.span,{style:{color:\"#79B8FF\"},children:\" true\"}),n(c.span,{style:{color:\"#E1E4E8\"},children:\";\"})]}),\"\\n\",n(c.span,{\"data-line\":\"\",children:\" \"}),\"\\n\",l(c.span,{\"data-line\":\"\",children:[n(c.span,{style:{color:\"#F97583\"},children:\"  const\"}),n(c.span,{style:{color:\"#B392F0\"},children:\" fetchData\"}),n(c.span,{style:{color:\"#F97583\"},children:\" =\"}),n(c.span,{style:{color:\"#F97583\"},children:\" async\"}),n(c.span,{style:{color:\"#E1E4E8\"},children:\" () \"}),n(c.span,{style:{color:\"#F97583\"},children:\"=>\"}),n(c.span,{style:{color:\"#E1E4E8\"},children:\" {\"})]}),\"\\n\",l(c.span,{\"data-line\":\"\",children:[n(c.span,{style:{color:\"#B392F0\"},children:\"    setTimeout\"}),n(c.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),n(c.span,{style:{color:\"#F97583\"},children:\"async\"}),n(c.span,{style:{color:\"#E1E4E8\"},children:\" () \"}),n(c.span,{style:{color:\"#F97583\"},children:\"=>\"}),n(c.span,{style:{color:\"#E1E4E8\"},children:\" {\"})]}),\"\\n\",l(c.span,{\"data-line\":\"\",children:[n(c.span,{style:{color:\"#F97583\"},children:\"      const\"}),n(c.span,{style:{color:\"#79B8FF\"},children:\" response\"}),n(c.span,{style:{color:\"#F97583\"},children:\" =\"}),n(c.span,{style:{color:\"#F97583\"},children:\" await\"}),n(c.span,{style:{color:\"#B392F0\"},children:\" fetch\"}),n(c.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),n(c.span,{style:{color:\"#9ECBFF\"},children:\"`https://swapi.dev/api/people/${\"}),n(c.span,{style:{color:\"#E1E4E8\"},children:\"props\"}),n(c.span,{style:{color:\"#9ECBFF\"},children:\".\"}),n(c.span,{style:{color:\"#E1E4E8\"},children:\"id\"}),n(c.span,{style:{color:\"#9ECBFF\"},children:\"}/`\"}),n(c.span,{style:{color:\"#E1E4E8\"},children:\");\"})]}),\"\\n\",l(c.span,{\"data-line\":\"\",children:[n(c.span,{style:{color:\"#F97583\"},children:\"      const\"}),n(c.span,{style:{color:\"#79B8FF\"},children:\" newData\"}),n(c.span,{style:{color:\"#F97583\"},children:\" =\"}),n(c.span,{style:{color:\"#F97583\"},children:\" await\"}),n(c.span,{style:{color:\"#E1E4E8\"},children:\" response.\"}),n(c.span,{style:{color:\"#B392F0\"},children:\"json\"}),n(c.span,{style:{color:\"#E1E4E8\"},children:\"();\"})]}),\"\\n\",l(c.span,{\"data-line\":\"\",\"data-highlighted-line\":\"\",children:[n(c.span,{style:{color:\"#F97583\"},children:\"      if\"}),n(c.span,{style:{color:\"#E1E4E8\"},children:\" (active) {\"})]}),\"\\n\",l(c.span,{\"data-line\":\"\",children:[n(c.span,{style:{color:\"#B392F0\"},children:\"        setFetchedId\"}),n(c.span,{style:{color:\"#E1E4E8\"},children:\"(props.id);\"})]}),\"\\n\",l(c.span,{\"data-line\":\"\",children:[n(c.span,{style:{color:\"#B392F0\"},children:\"        setData\"}),n(c.span,{style:{color:\"#E1E4E8\"},children:\"(newData);\"})]}),\"\\n\",n(c.span,{\"data-line\":\"\",children:n(c.span,{style:{color:\"#E1E4E8\"},children:\"      }\"})}),\"\\n\",l(c.span,{\"data-line\":\"\",children:[n(c.span,{style:{color:\"#E1E4E8\"},children:\"    }, Math.\"}),n(c.span,{style:{color:\"#B392F0\"},children:\"round\"}),n(c.span,{style:{color:\"#E1E4E8\"},children:\"(Math.\"}),n(c.span,{style:{color:\"#B392F0\"},children:\"random\"}),n(c.span,{style:{color:\"#E1E4E8\"},children:\"() \"}),n(c.span,{style:{color:\"#F97583\"},children:\"*\"}),n(c.span,{style:{color:\"#79B8FF\"},children:\" 12000\"}),n(c.span,{style:{color:\"#E1E4E8\"},children:\"));\"})]}),\"\\n\",n(c.span,{\"data-line\":\"\",children:n(c.span,{style:{color:\"#E1E4E8\"},children:\"  };\"})}),\"\\n\",n(c.span,{\"data-line\":\"\",children:\" \"}),\"\\n\",l(c.span,{\"data-line\":\"\",children:[n(c.span,{style:{color:\"#B392F0\"},children:\"  fetchData\"}),n(c.span,{style:{color:\"#E1E4E8\"},children:\"();\"})]}),\"\\n\",l(c.span,{\"data-line\":\"\",\"data-highlighted-line\":\"\",children:[n(c.span,{style:{color:\"#F97583\"},children:\"  return\"}),n(c.span,{style:{color:\"#E1E4E8\"},children:\" () \"}),n(c.span,{style:{color:\"#F97583\"},children:\"=>\"}),n(c.span,{style:{color:\"#E1E4E8\"},children:\" {\"})]}),\"\\n\",l(c.span,{\"data-line\":\"\",\"data-highlighted-line\":\"\",children:[n(c.span,{style:{color:\"#E1E4E8\"},children:\"    active \"}),n(c.span,{style:{color:\"#F97583\"},children:\"=\"}),n(c.span,{style:{color:\"#79B8FF\"},children:\" false\"}),n(c.span,{style:{color:\"#E1E4E8\"},children:\";\"})]}),\"\\n\",n(c.span,{\"data-line\":\"\",\"data-highlighted-line\":\"\",children:n(c.span,{style:{color:\"#E1E4E8\"},children:\"  };\"})}),\"\\n\",n(c.span,{\"data-line\":\"\",children:n(c.span,{style:{color:\"#E1E4E8\"},children:\"}, [props.id]);\"})})]})})}),\"\\n\",l(c.p,{children:[\"This fix relies on an often overlooked sentence in the \",n(c.a,{href:\"https://react.dev/learn/synchronizing-with-effects#step-3-add-cleanup-if-needed\",children:\"React Hooks API reference\"}),\":\"]}),\"\\n\",l(c.blockquote,{children:[\"\\n\",n(c.p,{children:\"Additionally, if a component renders multiple times (as they typically do), the previous effect is cleaned up before executing the next effect\\n.\"}),\"\\n\"]}),\"\\n\",n(c.p,{children:\"In the example above:\"}),\"\\n\",l(c.ul,{children:[\"\\n\",l(c.li,{children:[\"changing \",n(c.code,{children:\"props.id\"}),\" will cause a re-render,\"]}),\"\\n\",l(c.li,{children:[\"every re-render will trigger the clean-up function to run, setting \",n(c.code,{children:\"active\"}),\" to \",n(c.code,{children:\"false\"}),\",\"]}),\"\\n\",l(c.li,{children:[\"with \",n(c.code,{children:\"active\"}),\" set to \",n(c.code,{children:\"false\"}),\", the now-stale requests won't be able to update our state\"]}),\"\\n\"]}),\"\\n\",n(c.p,{children:\"You'll still have a race-condition in the sense that multiple requests will be in-flight,\\nbut only the results from the last one will be used.\"}),\"\\n\",l(c.p,{children:[\"It's likely not immediately obvious why the clean-up function in useEffect would fix this issue.\\nI'd recommend you see this fix in action, by checking out the \",n(c.a,{href:\"https://rb.gy/5tj3cp\",children:\"CodeSandbox\"}),\"\\n(I also added a counter to track the number of active requests, and couple of helper functions).\"]}),\"\\n\",n(c.h2,{id:\"useeffect-clean-up-function-with-abortcontroller\",children:n(c.a,{className:\"subheading-anchor\",\"aria-label\":\"Link to section\",href:\"#useeffect-clean-up-function-with-abortcontroller\",children:\"useEffect Clean-up Function with AbortController\"})}),\"\\n\",n(c.p,{children:\"Again, let's start with the code:\"}),\"\\n\",n(c.figure,{\"data-rehype-pretty-code-figure\":\"\",children:n(c.pre,{style:{backgroundColor:\"#24292e\",color:\"#e1e4e8\"},tabIndex:\"0\",\"data-language\":\"js\",\"data-theme\":\"github-dark\",children:l(c.code,{\"data-language\":\"js\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:[l(c.span,{\"data-line\":\"\",children:[n(c.span,{style:{color:\"#B392F0\"},children:\"useEffect\"}),n(c.span,{style:{color:\"#E1E4E8\"},children:\"(() \"}),n(c.span,{style:{color:\"#F97583\"},children:\"=>\"}),n(c.span,{style:{color:\"#E1E4E8\"},children:\" {\"})]}),\"\\n\",l(c.span,{\"data-line\":\"\",\"data-highlighted-line\":\"\",children:[n(c.span,{style:{color:\"#F97583\"},children:\"  const\"}),n(c.span,{style:{color:\"#79B8FF\"},children:\" abortController\"}),n(c.span,{style:{color:\"#F97583\"},children:\" =\"}),n(c.span,{style:{color:\"#F97583\"},children:\" new\"}),n(c.span,{style:{color:\"#B392F0\"},children:\" AbortController\"}),n(c.span,{style:{color:\"#E1E4E8\"},children:\"();\"})]}),\"\\n\",n(c.span,{\"data-line\":\"\",children:\" \"}),\"\\n\",l(c.span,{\"data-line\":\"\",children:[n(c.span,{style:{color:\"#F97583\"},children:\"  const\"}),n(c.span,{style:{color:\"#B392F0\"},children:\" fetchData\"}),n(c.span,{style:{color:\"#F97583\"},children:\" =\"}),n(c.span,{style:{color:\"#F97583\"},children:\" async\"}),n(c.span,{style:{color:\"#E1E4E8\"},children:\" () \"}),n(c.span,{style:{color:\"#F97583\"},children:\"=>\"}),n(c.span,{style:{color:\"#E1E4E8\"},children:\" {\"})]}),\"\\n\",l(c.span,{\"data-line\":\"\",children:[n(c.span,{style:{color:\"#B392F0\"},children:\"    setTimeout\"}),n(c.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),n(c.span,{style:{color:\"#F97583\"},children:\"async\"}),n(c.span,{style:{color:\"#E1E4E8\"},children:\" () \"}),n(c.span,{style:{color:\"#F97583\"},children:\"=>\"}),n(c.span,{style:{color:\"#E1E4E8\"},children:\" {\"})]}),\"\\n\",l(c.span,{\"data-line\":\"\",children:[n(c.span,{style:{color:\"#F97583\"},children:\"      try\"}),n(c.span,{style:{color:\"#E1E4E8\"},children:\" {\"})]}),\"\\n\",l(c.span,{\"data-line\":\"\",children:[n(c.span,{style:{color:\"#F97583\"},children:\"        const\"}),n(c.span,{style:{color:\"#79B8FF\"},children:\" response\"}),n(c.span,{style:{color:\"#F97583\"},children:\" =\"}),n(c.span,{style:{color:\"#F97583\"},children:\" await\"}),n(c.span,{style:{color:\"#B392F0\"},children:\" fetch\"}),n(c.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),n(c.span,{style:{color:\"#9ECBFF\"},children:\"`https://swapi.dev/api/people/${\"}),n(c.span,{style:{color:\"#E1E4E8\"},children:\"id\"}),n(c.span,{style:{color:\"#9ECBFF\"},children:\"}/`\"}),n(c.span,{style:{color:\"#E1E4E8\"},children:\", {\"})]}),\"\\n\",n(c.span,{\"data-line\":\"\",\"data-highlighted-line\":\"\",children:n(c.span,{style:{color:\"#E1E4E8\"},children:\"          signal: abortController.signal,\"})}),\"\\n\",n(c.span,{\"data-line\":\"\",children:n(c.span,{style:{color:\"#E1E4E8\"},children:\"        });\"})}),\"\\n\",l(c.span,{\"data-line\":\"\",children:[n(c.span,{style:{color:\"#F97583\"},children:\"        const\"}),n(c.span,{style:{color:\"#79B8FF\"},children:\" newData\"}),n(c.span,{style:{color:\"#F97583\"},children:\" =\"}),n(c.span,{style:{color:\"#F97583\"},children:\" await\"}),n(c.span,{style:{color:\"#E1E4E8\"},children:\" response.\"}),n(c.span,{style:{color:\"#B392F0\"},children:\"json\"}),n(c.span,{style:{color:\"#E1E4E8\"},children:\"();\"})]}),\"\\n\",n(c.span,{\"data-line\":\"\",children:\" \"}),\"\\n\",l(c.span,{\"data-line\":\"\",children:[n(c.span,{style:{color:\"#B392F0\"},children:\"        setFetchedId\"}),n(c.span,{style:{color:\"#E1E4E8\"},children:\"(id);\"})]}),\"\\n\",l(c.span,{\"data-line\":\"\",children:[n(c.span,{style:{color:\"#B392F0\"},children:\"        setData\"}),n(c.span,{style:{color:\"#E1E4E8\"},children:\"(newData);\"})]}),\"\\n\",l(c.span,{\"data-line\":\"\",children:[n(c.span,{style:{color:\"#E1E4E8\"},children:\"      } \"}),n(c.span,{style:{color:\"#F97583\"},children:\"catch\"}),n(c.span,{style:{color:\"#E1E4E8\"},children:\" (error) {\"})]}),\"\\n\",l(c.span,{\"data-line\":\"\",children:[n(c.span,{style:{color:\"#F97583\"},children:\"        if\"}),n(c.span,{style:{color:\"#E1E4E8\"},children:\" (error.name \"}),n(c.span,{style:{color:\"#F97583\"},children:\"===\"}),n(c.span,{style:{color:\"#9ECBFF\"},children:' \"AbortError\"'}),n(c.span,{style:{color:\"#E1E4E8\"},children:\") {\"})]}),\"\\n\",n(c.span,{\"data-line\":\"\",children:n(c.span,{style:{color:\"#6A737D\"},children:\"          // Aborting a fetch throws an error\"})}),\"\\n\",n(c.span,{\"data-line\":\"\",children:n(c.span,{style:{color:\"#6A737D\"},children:\"          // So we can't update state afterwards\"})}),\"\\n\",n(c.span,{\"data-line\":\"\",children:n(c.span,{style:{color:\"#E1E4E8\"},children:\"        }\"})}),\"\\n\",n(c.span,{\"data-line\":\"\",children:n(c.span,{style:{color:\"#6A737D\"},children:\"        // Handle other request errors here\"})}),\"\\n\",n(c.span,{\"data-line\":\"\",children:n(c.span,{style:{color:\"#E1E4E8\"},children:\"      }\"})}),\"\\n\",l(c.span,{\"data-line\":\"\",children:[n(c.span,{style:{color:\"#E1E4E8\"},children:\"    }, Math.\"}),n(c.span,{style:{color:\"#B392F0\"},children:\"round\"}),n(c.span,{style:{color:\"#E1E4E8\"},children:\"(Math.\"}),n(c.span,{style:{color:\"#B392F0\"},children:\"random\"}),n(c.span,{style:{color:\"#E1E4E8\"},children:\"() \"}),n(c.span,{style:{color:\"#F97583\"},children:\"*\"}),n(c.span,{style:{color:\"#79B8FF\"},children:\" 12000\"}),n(c.span,{style:{color:\"#E1E4E8\"},children:\"));\"})]}),\"\\n\",n(c.span,{\"data-line\":\"\",children:n(c.span,{style:{color:\"#E1E4E8\"},children:\"  };\"})}),\"\\n\",n(c.span,{\"data-line\":\"\",children:\" \"}),\"\\n\",l(c.span,{\"data-line\":\"\",children:[n(c.span,{style:{color:\"#B392F0\"},children:\"  fetchData\"}),n(c.span,{style:{color:\"#E1E4E8\"},children:\"();\"})]}),\"\\n\",l(c.span,{\"data-line\":\"\",\"data-highlighted-line\":\"\",children:[n(c.span,{style:{color:\"#F97583\"},children:\"  return\"}),n(c.span,{style:{color:\"#E1E4E8\"},children:\" () \"}),n(c.span,{style:{color:\"#F97583\"},children:\"=>\"}),n(c.span,{style:{color:\"#E1E4E8\"},children:\" {\"})]}),\"\\n\",l(c.span,{\"data-line\":\"\",\"data-highlighted-line\":\"\",children:[n(c.span,{style:{color:\"#E1E4E8\"},children:\"    abortController.\"}),n(c.span,{style:{color:\"#B392F0\"},children:\"abort\"}),n(c.span,{style:{color:\"#E1E4E8\"},children:\"();\"})]}),\"\\n\",n(c.span,{\"data-line\":\"\",\"data-highlighted-line\":\"\",children:n(c.span,{style:{color:\"#E1E4E8\"},children:\"  };\"})}),\"\\n\",n(c.span,{\"data-line\":\"\",children:n(c.span,{style:{color:\"#E1E4E8\"},children:\"}, [id]);\"})})]})})}),\"\\n\",l(c.p,{children:[\"Like in the previous example, we're taking advantage of React's behavior of running the clean-up function before executing the next effect. You can explore this in the \",n(c.a,{href:\"https://rb.gy/xx6ejb\",children:\"CodeSandbox\"}),\" as well (in this case, we're not tracking the number of requests since only one can be active at any given time).\"]}),\"\\n\",n(c.p,{children:\"In this example, we are:\"}),\"\\n\",l(c.ul,{children:[\"\\n\",l(c.li,{children:[\"Initializing an \",n(c.code,{children:\"AbortController\"}),\" at the start of the effect.\"]}),\"\\n\",l(c.li,{children:[\"Passing the \",n(c.a,{href:\"https://developer.mozilla.org/en-US/docs/Web/API/AbortController/signal\",children:n(c.code,{children:\"AbortController.signal\"})}),\" to the \",n(c.code,{children:\"fetch\"}),\" function via the options argument.\"]}),\"\\n\",l(c.li,{children:[\"Catching any \",n(c.code,{children:\"AbortErrors\"}),\" that are thrown (when \",n(c.code,{children:\"abort()\"}),\" is called, the \",n(c.code,{children:\"fetch()\"}),\" promise rejects with an \",n(c.code,{children:\"AbortError\"}),\"; see \",n(c.a,{href:\"https://developer.mozilla.org/en-US/docs/Web/API/AbortController/abort\",children:\"MDN reference\"}),\").\"]}),\"\\n\",n(c.li,{children:\"Calling the abort function within the clean-up function.\"}),\"\\n\"]}),\"\\n\",n(c.p,{children:\"This approach presents a trade-off: you'll need to drop support for Internet Explorer or use a polyfill in exchange for the ability to cancel in-progress HTTP requests.\"})]})}return{default:function(e={}){const{wrapper:l}=e.components||{};return l?n(l,{...e,children:n(_createMdxContent,{...e})}):_createMdxContent(e)}};",
    "slugAsParams": "race-condition-react"
  }
]